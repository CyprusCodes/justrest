const { submitQuery, sql, sqlReduce } = require("~root/lib/database");

const update{{entityName | toPascalCase}} = ({{ argsColumns | functionParameters }}) => {
    const updates = [];
    
    {% for column in columnsToUpdate %}
    if ({{ column | toCamelCase }}) {
        updates.push(sql`{{ column | toSnakeCase }} = ${ {{ column | toCamelCase }} }`);
    }
    {% endfor %}
    
    if (updates.length !== 0) {
        return submitQuery`
        UPDATE
            {{ entityName | toSnakeCase }}
        SET
            ${updates.reduce(sqlReduce)}
        WHERE
            {{ filterColumns | sqlFilters }}
        `;
    }

    return Promise.resolve();
};

module.exports = update{{ entityName | toPascalCase }};